이 프로젝트는 STM32 마이크로컨트롤러에서 UART 통신을 사용하여 데이터를 송수신하는 예제 코드입니다. 송신과 수신은 DMA(Direct Memory Access)를 활용하여 비차단적으로 처리됩니다. 송신 데이터는 "안녕 안녕~~!"이며, 수신 데이터는 64바이트 버퍼에 저장됩니다. 수신이 완료되면 해당 데이터를 송신하는 구조로 동작합니다.

기능
UART 송신: DMA를 사용하여 "안녕 안녕~~!" 문자열을 UART를 통해 송신.
UART 수신: DMA를 사용하여 UART로부터 데이터를 비차단적으로 수신하고, 수신 완료 후 해당 데이터를 다시 송신.
DMA 사용: UART 통신의 송수신을 DMA를 사용하여 CPU 부하를 줄이고 효율적인 데이터 처리.
사용된 주요 함수
HAL_Init()

HAL 라이브러리를 초기화하여 시스템 설정을 준비합니다.
SystemClock_Config()

시스템 클럭을 설정합니다. HSI(High-Speed Internal) 오실레이터와 PLL(Phase-Locked Loop)을 사용하여 클럭을 구성합니다.
MX_GPIO_Init()

GPIO를 초기화합니다. B1 핀(입력)과 LD4 핀(출력)을 설정합니다.
B1 핀은 외부 인터럽트를 사용하여 버튼 눌림을 감지합니다.
LD4 핀은 출력으로 설정하여 상태를 표시할 수 있습니다.
MX_DMA_Init()

DMA를 초기화하고, UART2의 송수신을 위한 DMA 채널을 설정합니다. 수신은 DMA1_Channel6을 사용하고, 송신은 DMA1_Channel7을 사용합니다.
MX_USART2_UART_Init()

USART2 UART 인터페이스를 초기화합니다. 보드레이트 9600, 데이터 길이 8비트, 1스톱 비트 등 설정을 지정합니다.
HAL_UART_RxCpltCallback()

UART 수신이 완료되면 호출되는 콜백 함수입니다. 수신된 데이터를 rx_data 버퍼에 저장하고, 이를 다시 송신합니다.
Error_Handler()

오류가 발생하면 호출되어 무한 루프에 빠집니다. 이 함수는 디버깅 용도로 사용됩니다.
코드 흐름 설명
초기화: HAL_Init(), SystemClock_Config(), MX_GPIO_Init(), MX_DMA_Init(), MX_USART2_UART_Init() 함수들이 호출되어 시스템과 UART 및 DMA를 초기화합니다.
송신: HAL_UART_Transmit_DMA() 함수는 DMA를 통해 "안녕 안녕~~!" 문자열을 UART를 통해 송신합니다.
수신: HAL_UART_Receive_DMA() 함수는 DMA를 통해 UART로부터 데이터를 비차단적으로 수신하기 시작합니다.
수신 완료 처리: UART 수신이 완료되면 HAL_UART_RxCpltCallback() 콜백 함수가 호출됩니다. 수신된 데이터를 처리하고, 이를 다시 송신하는 방식으로 동작합니다.
주요 사용 이유
DMA 사용: DMA를 사용하여 UART 송수신을 비차단적으로 처리합니다. CPU의 부하를 줄이고 효율적인 데이터 송수신을 가능하게 합니다.
콜백 함수: UART 수신 완료 후 자동으로 처리할 수 있도록 콜백 함수를 사용하여 실시간으로 수신된 데이터를 처리합니다.
동작 흐름
시작: 시스템 초기화 후 송신 데이터("안녕 안녕~~!")가 UART를 통해 송신됩니다.
수신 대기: UART 수신이 DMA로 비차단적으로 시작되고, 수신이 완료되면 HAL_UART_RxCpltCallback() 함수가 호출됩니다.
수신된 데이터 처리: 수신된 데이터가 rx_data 버퍼에 저장되고, 이를 다시 송신합니다.
하드웨어 요구사항
STM32 마이크로컨트롤러: 해당 코드는 STM32 MCU에서 실행됩니다.
UART 연결: UART2 포트를 사용하여 외부 장치와 통신합니다.
참고 사항
코드에서 사용하는 DMA 및 UART 설정은 STM32의 하드웨어와 구성에 맞게 조정해야 할 수 있습니다.
이 예제는 송신 후 수신을 즉시 처리하는 간단한 예제이며, 더 복잡한 통신 프로토콜이나 처리가 필요한 경우 추가적인 코드 구현이 필요합니다.
